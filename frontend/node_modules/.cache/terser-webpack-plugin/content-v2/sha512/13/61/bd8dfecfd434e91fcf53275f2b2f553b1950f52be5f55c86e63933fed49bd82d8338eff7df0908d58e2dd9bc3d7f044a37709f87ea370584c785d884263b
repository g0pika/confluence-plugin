{"code":"(window.atlassianWebpackJsonp443cd0279e0da119d0d4637a8a554bda=window.atlassianWebpackJsonp443cd0279e0da119d0d4637a8a554bda||[]).push([[4],{228:function(e,t,a){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.default=void 0;var n=s(a(0)),o=s(a(40));function s(e){return e&&e.__esModule?e:{default:e}}function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var r=function(e){return n.default.createElement(o.default,l({dangerouslySetGlyph:'<svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" focusable=\"false\" role=\"presentation\"><g fill-rule=\"evenodd\"><circle fill=\"currentColor\" cx=\"12\" cy=\"12\" r=\"10\"/><path d=\"M13.477 9.113l-4.36 4.386a1 1 0 1 0 1.418 1.41l4.36-4.386a1 1 0 0 0-1.418-1.41z\" fill=\"inherit\"/><path d=\"M9.084 10.501l4.358 4.377a1 1 0 1 0 1.418-1.411L10.5 9.09a1 1 0 0 0-1.417 1.411z\" fill=\"inherit\"/></g></svg>'},e))};r.displayName=\"CrossCircleIcon\";var i=r;t.default=i},238:function(e,t,a){\"use strict\";a.r(t);var n=a(0),o=a.n(n),s=a(192),l=a(190),r=a(196);!function(){var e=new Error(\"Cannot find module '@atlaskit/checkbox'\");throw e.code=\"MODULE_NOT_FOUND\",e}(),function(){var e=new Error(\"Cannot find module '@atlaskit/tokens'\");throw e.code=\"MODULE_NOT_FOUND\",e}();const i=(e,t,a)=>{let n=[];return null!==e&&(console.log(\"values\",e),e.map(e=>{console.log(\"item\",e.name),n.push({cells:[{key:e.name,content:e.name,isSortable:!0},{key:e.name+e.status,content:o.a.createElement(\"div\",{style:{marginLeft:\"45px\"}},o.a.createElement(!function(){var e=new Error(\"Cannot find module '@atlaskit/checkbox'\");throw e.code=\"MODULE_NOT_FOUND\",e}(),{value:\"1\",name:\"checkbox-basic\",isDisabled:a,defaultChecked:e.status,onChange:a=>{t(a.currentTarget.checked,e)}})),isSortable:!0}],key:e.name+e.status})})),n},c={head:{cells:[{key:\"head key1\",content:o.a.createElement(\"h5\",{style:{color:!function(){var e=new Error(\"Cannot find module '@atlaskit/tokens'\");throw e.code=\"MODULE_NOT_FOUND\",e}()(\"color.text\")}},\"Group\"),width:84,shouldTruncate:!0},{key:\"head key2\",content:o.a.createElement(\"h5\",{style:{color:!function(){var e=new Error(\"Cannot find module '@atlaskit/tokens'\");throw e.code=\"MODULE_NOT_FOUND\",e}()(\"color.text\")}},\"Insights \"),colSpan:20,shouldTruncate:!0}]}},d={head:{cells:[{key:\"head key1\",width:42,content:o.a.createElement(\"h5\",{style:{color:!function(){var e=new Error(\"Cannot find module '@atlaskit/tokens'\");throw e.code=\"MODULE_NOT_FOUND\",e}()(\"color.text\")}},\"Name\")},{key:\"head key2\",content:o.a.createElement(\"h5\",{style:{color:!function(){var e=new Error(\"Cannot find module '@atlaskit/tokens'\");throw e.code=\"MODULE_NOT_FOUND\",e}()(\"color.text\")}},\"Key\"),width:42},{key:\"head key2\",content:o.a.createElement(\"h5\",{style:{color:!function(){var e=new Error(\"Cannot find module '@atlaskit/tokens'\");throw e.code=\"MODULE_NOT_FOUND\",e}()(\"color.text\")}},\"Operations\")}]}};var u=a(194),p=a(211),m=a.n(p),h=a(228),f=a.n(h),g=a(202),E=a.n(g),y=a(176),w=a(235);!function(){var e=new Error(\"Cannot find module '@atlaskit/tokens'\");throw e.code=\"MODULE_NOT_FOUND\",e}();const k=e=>{const[t,a]=Object(n.useState)(0),[s,l]=Object(n.useState)(1);return Object(n.useEffect)(()=>{a(i(e.data,e.onChangecheck,e.ButtonState)),console.log(\"actual syn\",t),console.log(\"calling before transform\")},[e.data,e.onChangecheck,e.ButtonState]),o.a.createElement(y.a,{head:e.head,rows:t,rowsPerPage:5,isLoading:e.loading,onSetPage:t=>{a(i(e.data,e.onChangecheck,e.ButtonState)),l(t)},page:s,emptyView:o.a.createElement(\"h6\",{style:{color:!function(){var e=new Error(\"Cannot find module '@atlaskit/tokens'\");throw e.code=\"MODULE_NOT_FOUND\",e}()(\"color.text\")}},\"No matching records found\")})},O=e=>{let t=((e,t,a)=>{let n=e=>{if(window.location.search&&new RegExp(e+\"=([^&]*)\").exec(window.location.search)){var t=new RegExp(e+\"=([^&]*)\").exec(window.location.search)[1];return decodeURIComponent(t)}return\"\"},s=n(\"xdm_e\")+n(\"cp\"),l=[];return null!==e&&(console.log(\"values\",e),e.map(e=>{console.log(e),l.push({cells:[{key:e.key,content:e.name,isSortable:!0},{key:e.key,content:e.key,isSortable:!0},{key:e.key,content:o.a.createElement(\"a\",{target:\"_blank\",rel:\"noopener noreferrer\",href:s+\"/plugins/atlassian-connect/space-tools-tab.action?key=\"+e.key+\"&addonKey=com.view26.pageview-insights.spaces.confluence&moduleKey=view26-insights-permission\"},\" \",\"Manage Permissions\"),isSortable:!0}],key:e.key})})),l})(e.data);return o.a.createElement(w.a,{head:e.head,rows:t,rowsPerPage:5,isLoading:e.loading,emptyView:o.a.createElement(\"h6\",{style:{color:!function(){var e=new Error(\"Cannot find module '@atlaskit/tokens'\");throw e.code=\"MODULE_NOT_FOUND\",e}()(\"color.text\")}},\"No matching records found\")})};var v=a(116);!function(){var e=new Error(\"Cannot find module '@atlaskit/tokens'\");throw e.code=\"MODULE_NOT_FOUND\",e}();t.default=()=>{const[e,t]=Object(n.useState)(null),[a,i]=Object(n.useState)(!0),[p,h]=Object(n.useState)(!1),[g,y]=Object(n.useState)(\"None\"),[w,b]=Object(n.useState)(),[T,N]=Object(n.useState)(null),[S,x]=Object(n.useState)(null),[C,_]=Object(n.useState)(!0),[D,U]=Object(n.useState)(!0);let P=0,j=0,L=0,z=0,F=(e,t)=>{let a=[],n=[],o=[];return t.permissions.map(e=>{n.push(e.name)}),e.results.map(e=>{a.push(e.name)}),a.forEach(e=>{n.includes(e)?o.push({name:e,status:!0}):o.push({name:e,status:!1})}),console.log(\"state array\",o),o};const M=e=>(console.log(\"refunction\",e),new Promise((function(t,a){window.AP.request(\"/rest/api/group?start=\"+e,{contentType:\"application/json; charset=utf-8\",type:\"GET\",success:function(e){let a=JSON.parse(e),n=a.limit;P+=a.size,console.log(\"limit refunction\",j,P,n),t(j<=P?a.results.slice():M(n))},error:function(e){a(JSON.parse(e))}})})));Object(n.useEffect)(()=>{window.AP.request(\"/rest/api/group?start=0\",{contentType:\"application/json; charset=utf-8\",type:\"GET\",success:async function(a){let n=JSON.parse(a);j=n.size;let o=n.limit;P+=o;let s=n.results.slice();if(j>P){(await M(o)).forEach(e=>{s.push(e)})}console.log(\"final result\",s),n.results.splice(0,n.results.length),s.forEach((function(e,t){n.results.push({key:e.name,name:e.name,type:e.type,profilePicURL:\"/app/favicon.png\"})})),console.log(\"response result\",n.results);let l=document.getElementById(\"jwt\");if(console.log(\"meta\",l),l){let a=l.content;console.log(\"Jwt token from index.html\",a),E.a.get(\"/permissions\",{headers:{Authorization:a}}).then(a=>{x(a.headers.authorization);let o=F(n,a.data);b(a.data.spaceOverGlobal),console.log(\"permissions data\",o),t(o),_(!1),console.info(\"table state\",e)}).catch(e=>{console.info(\"Permission data failed\",e.response)})}else window.AP.context.getToken(a=>{E.a.post(\"/authorize?jwt=\"+a+\"&spaceKey=&lic=active\").then(a=>{E.a.get(\"/permissions\",{headers:{Authorization:a.headers.authorization}}).then(a=>{x(a.headers.authorization);let o=F(n,a.data);b(a.data.spaceOverGlobal),console.log(\"permissions data\",o),t(o),_(!1),console.info(\"table state\",e)}).catch(e=>{console.info(\"Permission data failed\",e.response)})})})}}),window.AP.request(\"/rest/api/space?start=0\",{contentType:\"application/json; charset=utf-8\",type:\"GET\",success:async function(e){let t=JSON.parse(e);z=t.size;let a=t.limit;L+=a;let n=t.results.slice();if(t.results.splice(0,t.results.length),z>L){(await(e=>(console.log(\"refunction\",e),new Promise((function(t,a){window.AP.request(\"/rest/api/space?start=\"+e,{contentType:\"application/json; charset=utf-8\",type:\"GET\",success:function(e){let a=JSON.parse(e),n=a.limit;L+=a.size,console.log(\"limit refunction\",z,L,n),t(z<=L?a.results.slice():M(n))},error:function(e){a(JSON.parse(e))}})}))))(a)).forEach(e=>{n.push(e)})}console.log(\"actual results\",n),n.forEach((function(e,a){t.results.push({key:e.key,name:e.name,type:e._links.self,profilePicURL:\"/app/favicon.png\"})})),console.log(\"results of space\",t),N(t.results),U(!1)}})},[]);let I=t=>{if(t===w){let a=[];e.map(e=>{e.status&&(console.log(\"element with true\",e),a.push({key:e.name,name:e.name,type:\"group\",profilePicURL:\"/app/favicon.png\"}))});let n={permissions:a,spaceOverGlobal:!t};console.log(\"spacepermsiion payload\",n),E.a.post(\"/permissions\",n,{headers:{Authorization:S}}).then(e=>{console.info(\"Space dropdown changed\"),x(e.headers.authorization)}).catch(e=>{console.info(\"Space dropdown changed Failed \",e.response),console.info(\"Request payload \",n)}),b(!t)}};return o.a.createElement(v.b,null,o.a.createElement(\"div\",{style:{padding:25},className:\"ac-content\"},o.a.createElement(\"h3\",null,\"Global Permissions\"),o.a.createElement(\"div\",{style:{paddingTop:\"10px\",display:\"flex\",flexDirection:\"row\",justifyContent:\"space-between\"}},o.a.createElement(\"p\",null,\"Grant access to Insights for all the members of a group.\"),o.a.createElement(\"div\",null,o.a.createElement(u.a,{onClick:()=>{if(a)i(!1);else{i(!0);let t=[];console.log(\"Table state inside button click\",e),e.map(e=>{e.status&&(console.log(\"element wit true\",e),t.push({key:e.name,name:e.name,type:\"group\",profilePicURL:\"/app/favicon.png\"}))}),console.log(\"permission change request payload\",t),E.a.post(\"/permissions\",{permissions:t,spaceOverGlobal:w},{headers:{Authorization:S}}).then(e=>{console.info(\"Permissions changed\"),x(e.headers.authorization)}).catch(e=>{console.info(\"Permission change error \",e.response),console.info(\"Request payload \",t)})}},appearance:a?\"default\":\"primary\"},a?\"Edit Settings\":\"Save Settings\"))),o.a.createElement(\"div\",{style:{marginTop:\"5px\"}},o.a.createElement(k,{head:c.head,data:e,onChangecheck:(a,n)=>{let o=e;if(a)a&&(s=o.findIndex(e=>e.name===n.name),o[s]={name:n.name,status:!0},t(o));else{var s=o.findIndex(e=>e.name===n.name);o[s]={name:n.name,status:!1},t(o)}},ButtonState:a,loading:C}),o.a.createElement(\"h3\",null,\"Space Permissions\"),o.a.createElement(\"div\",{style:{marginTop:\"30px\",alignSelf:\"center\"}},o.a.createElement(s.a,{trigger:o.a.createElement(\"div\",null,w?o.a.createElement(n.Fragment,null,o.a.createElement(f.a,{primaryColor:\"red\",size:\"small\"}),\" If specified, space permission overrides global permission scheme\"):o.a.createElement(n.Fragment,null,o.a.createElement(m.a,{primaryColor:\"green\",size:\"small\"}),\" \",\"Allow global permission scheme to be applied to all Spaces\")),boundariesElement:\"window\",shouldFitContainer:\"false\",triggerType:\"button\"},o.a.createElement(l.a,{id:\"asda\",title:\"Options\"},o.a.createElement(r.a,{elemBefore:o.a.createElement(m.a,{primaryColor:\"green\",size:\"small\"}),style:{color:!function(){var e=new Error(\"Cannot find module '@atlaskit/tokens'\");throw e.code=\"MODULE_NOT_FOUND\",e}()(\"color.text\")},onClick:()=>I(!0)},\"Allow global permission scheme to be applied to all Spaces\"),o.a.createElement(r.a,{elemBefore:o.a.createElement(f.a,{primaryColor:\"red\",size:\"small\"}),onClick:()=>I(!1),style:{color:!function(){var e=new Error(\"Cannot find module '@atlaskit/tokens'\");throw e.code=\"MODULE_NOT_FOUND\",e}()(\"color.text\")}},\"If specified, space permission overrides global permission scheme\")))),o.a.createElement(\"div\",{style:{paddingTop:\"10px\",marginTop:\"30px\",color:!function(){var e=new Error(\"Cannot find module '@atlaskit/tokens'\");throw e.code=\"MODULE_NOT_FOUND\",e}()(\"color.text\")}},\"Further restrict who can use\",o.a.createElement(\"span\",{style:{fontWeight:\"bold\"}},\" Insights \"),\" at a space level.\"),o.a.createElement(\"div\",{style:{marginTop:\"5px\"}},o.a.createElement(O,{head:d.head,data:T,loading:D})),o.a.createElement(\"div\",null,o.a.createElement(\"h3\",null,\"REST API Token\"),o.a.createElement(\"div\",{style:{paddingTop:\"10px\"}},\"Your API key can be used to authenticate you when using the REST API. To use the API key refer to\",\" \",o.a.createElement(\"a\",{target:\"_blank\",rel:\"noopener noreferrer\",href:\"https://docs-view26.atlassian.net/wiki/spaces/PVIFC/pages/474972171/REST+API\"},\" \",\"REST API documentation.\")),o.a.createElement(\"div\",{style:{paddingTop:\"10px\",display:\"flex\",flexDirection:\"row\",justifyContent:\"space-between\"}},o.a.createElement(\"div\",{style:{paddingRight:\"50px\"}},p?o.a.createElement(\"div\",null,\" Token ID: \",g):o.a.createElement(\"div\",null,\" Token ID: \",g,\" \")),o.a.createElement(\"div\",{style:{alignContent:\"flex-end\"}},o.a.createElement(u.a,{onClick:()=>{p?(h(!1),y(\"None\")):(h(!0),E.a.post(\"/account/token\",{},{headers:{Authorization:S}}).then(e=>{x(e.headers.authorization),console.info(\"Token data\",e.data),y(e.data.token),h(!0)}).catch(e=>{console.info(\"Token failed\",e.response)}))}},p?o.a.createElement(\"div\",null,\"Revoke \"):o.a.createElement(\"div\",null,\"Generate \"))))))))}}}]);","extractedComments":[]}